# Устранение неполадок с производительностью в osu!

osu! делает всё возможное, чтобы хорошо работать с настройками по умолчанию и заранее предупреждать, если вы делаете или запускаете что-то, что может отрицательно влиять на производительность игры.

К сожалению, из-за обилия различных аппаратных конфигураций, на которых работает osu!, очень сложно обеспечить оптимальную производительность для каждого пользователя. Эта страница предназначена для помощи в самостоятельной диагностике проблем с производительностью (при их наличии), а также содержит определённые термины и действия, которые помогут нам с предоставлением более качественной поддержки в случае вашего обращения.

## Различные виды "лагов"

Довольно сложно предоставить поддержку, когда любая проблема классифицируется словом "лаг", так что для начала необходимо определиться с терминологией для каждого случая.

### Проблемы со звуком

Звуковая дорожка карты перематывается или глючит. В основном, когда игра лагает, это можно услышать по звуку. При диагностике или обращении в поддержку могут помочь следующие действия:

- Проверьте, случается ли это на всех доступных аудиоустройствах. Если вы используете USB-гарнитуру, то попробуйте подключить её к 3.5мм выходу на вашем ПК.
- Проверьте, помогает ли включение опции "Audio compatibility mode" в настройках osu!.

### Просадки FPS

Во время игры всё на экране подвисает так, что мешает играть. Это может происходить периодически, через случайные или постоянные промежутки времени. При диагностике или обращении в поддержку могут помочь следующие действия:

- Посчитайте, сколько раз это случается в средней игровой сессии.
- Проверьте, всегда ли наблюдаются фризы/скачки FPS.
- Проверьте, насколько часто это происходит, равные ли промежутки времени между фризами?
- Проверьте, есть ли эта проблема сразу после перезагрузки ПК.
- Попробуйте закрыть все программы, которые используют внутриигровые оверлеи (Discord, Steam, NVIDIA Shadowplay и т.д.).
- Если вы используете Windows 10, то убедитесь, что у вас включен [режим игры](https://www.windowscentral.com/how-enable-disable-game-mode-windows-10). Он позволяет Windows выделять ресурсы специально для osu!
- Откройте диспетчер задач и включите сортировку списка во вкладке "Подробности" по ЦП. Следите за любой программой, которая сильно нагружает процессор во время фризов, это может быть антивирус, работающий в фоне, например. Можно запустить osu! в оконном режиме или перенести диспетчер задач на другой монитор, чтобы следить за нагрузкой во время игры.

### Задержка ввода

Есть заметная задержка между вводом с клавиатуры/мыши/графического планшета и действием на экране. При диагностике или обращении в поддержку могут помочь следующие действия:

- Проверьте, есть ли такой симптом на всех устройствах ввода, или только на одном.
- Если вы используете сторонние драйверы, попробуйте заменить их на официальные.
- Убедитесь, что osu! у вас работает в полноэкранном режиме, так как в оконном режиме выше задержка.

### Потеря управления

Во время игры одно или более устройств ввода перестают работать. На экране всё отображается корректно, но играть невозможно до тех пор, пока управление не придёт в норму. При диагностике или обращении в поддержку могут помочь следующие действия:

- Нажмите Ctrl+F11 для включения графика времени кадра. Проверьте, много ли белого цвета на графике в тот момент, когда девайсы перестают работать (это означает, что другая программа или драйвер используют слишком много ресурсов процессора, добавляя задержку ввода).

### Низкий FPS

Во время игры наблюдается низкая частота кадров, в результате чего объекты на экране могут трястись. Это также может привести к более высокой задержке ввода. При диагностике или обращении в поддержку могут помочь следующие действия:

- Проверьте, есть ли эта проблема сразу после перезагрузки ПК.
- Попробуйте закрыть все программы, которые используют внутриигровые оверлеи (Discord, Steam, NVIDIA Shadowplay и т.д.).
- Убедитесь, что в видеодрайвере у вас не включена принудительная вертикальная синхронизация (она должна быть либо выключена, либо "по усмотрению приложения").
- Попробуйте различные настройки ограничения FPS.
- Убедитесь, что osu! работает в полноэкранном режиме (не в окне без рамки), это всегда повышает производительность.
- Убедитесь, что у вас включен [режим игры](https://www.windowscentral.com/how-enable-disable-game-mode-windows-10) (Windows 10). Он позволяет Windows выделять ресурсы специально для osu!.
- Откройте диспетчер задач и включите сортировку списка во вкладке "Подробности" по ЦП. Следите за любой программой, которая сильно нагружает процессор во время низкого FPS; это может быть антивирус, работающий в фоне, например. Можно запустить osu! в оконном режиме или перенести диспетчер задач на другой монитор, чтобы следить за нагрузкой во время игры.

## Ограничение FPS

В osu! есть несколько значений ограничения частоты кадров. У каждого есть плюсы и минусы. Важно заметить, что osu! независимо от этого параметра ограничивает FPS в меню для снижения нагрузки на процессор.

### Вертикальная синхронизация (VSync)

Эта настройка использует механизм вертикальной синхронизации, предоставленный видеодрайвером. Она гарантирует отсутствие разрывов изображения, но добавляет задержку в 1-2 кадра из-за необходимости отправки кадров в буфер перед их отображением.

Не рекомендуется для дисплеев с частотой обновления 60Гц. Вертикальная синхронизация становится более полезной при частоте обновления выше 120Гц, но при наличии GSync и FreeSync уже не нужна.

### Power Saving

Эта настройка нацелена на понижение энергопотребления, предоставляя стабильный геймплей. Она ограничит частоту кадров двухкратной частотой обновления монитора и будет придерживаться постоянной частоты кадров.

Рекомендуется для старых ПК или для энергосбережения на ноутбуках.

### Optimal

Эта настройка ограничит частоту кадров восьмикратной частотой обновления монитора, с максимально возможным значением, равным 960. Мы рекомендуем использовать именно это ограничение FPS для тех, кто не хочет сильно нагружать процессор/видеокарту, в то же время сохраняя высокий уровень производительности с низкой задержкой ввода.

Данная опция более предпочтительна, чем отсутствие ограничения, так как высокая частота кадров ведёт к увеличенному использованию ресурсов ПК для [сборки мусора](https://ru.wikipedia.org/wiki/Сборка_мусора), что в свою очередь, может привести к фризам/просадкам FPS.

### Нет (во время игры)

При этой настройке никакого ограничения частоты кадров нет. osu! будет рендерить столько кадров, сколько позволяет ваш процессор/видеокарта.

Может показаться, что данный вариант является наилучшим (и, конечно же, может быть наилучшим, если ваш ПК позволяет), но вы должны учитывать следующее:

- При высокой частоте кадров увеличиваются затраты ресурсов на сборку мусора.
- Создавая максимальную нагрузку на ваши процессор и видеокарту, появляется вероятность троттлинга, что в целом понизит производительность.
- Вообще, видеокарты не рассчитаны на рендеринг 1000+ кадров в секунду, поэтому могут произойти какие-либо неожиданные случаи, включая понижение производительности или более высокую задержку, в сравнении с другими ситуациями.

Тем не менее, если повышенное тепловыделение и потенциальная перегрузка вашего железа не являются проблемой, то отсутствие ограничения частоты кадров может предоставить наиболее стабильное время кадра.
